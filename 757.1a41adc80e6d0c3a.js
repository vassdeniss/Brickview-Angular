"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[757],{7757:(re,f,c)=>{c.r(f),c.d(f,{ReviewModule:()=>oe});var d=c(6814),b=c(6208),l=c(6223),p=c(649),Z=c(4202),w=c(9246),g=c(8915),e=c(5879),h=c(8394),v=c(8998),_=c(2864),m=c(3911);function O(n,r){if(1&n&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Oqu(t)}}function M(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"app-popup",12),e.NdJ("closed",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.popup.hide())}),e.ALo(1,"translate"),e.YNc(2,O,2,1,"p",13),e.qZA()}if(2&n){const t=e.oxw();e.s9C("title",e.lcZ(1,2,"general.error")),e.xp6(2),e.Q6J("ngForOf",t.errors)}}function y(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",14),e._UZ(1,"img",15),e.TgZ(2,"a",16),e.NdJ("click",function(){const a=e.CHM(t).index,s=e.oxw();return e.KtG(s.deleteImage(a))}),e._uU(3,"\xd7"),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(1),e.Q6J("src",t,e.LSH)}}let P=(()=>{class n{constructor(t,i,o,a,s){this.activated=t,this.route=i,this.fb=o,this.popup=a,this.review=s,this.errors=[],this.images=[],this.reviewForm=this.fb.group({content:["",[l.kI.required,l.kI.minLength(50),l.kI.maxLength(5e3)]],images:[""],setImages:[this.images],setVideoIds:[""],_id:[""]},{validator:this.linkValidator("setVideoIds")}),this.toolbar=[["bold","italic"],["underline","strike"],["ordered_list","bullet_list"],[{heading:["h1","h2","h3","h4","h5","h6"]}],["text_color","background_color"],["align_left","align_center","align_right","align_justify"]]}ngOnInit(){this.reviewForm.patchValue({_id:this.activated.snapshot.params.id}),this.editor=new g.ML}ngOnDestroy(){this.editor.destroy()}onSubmit(t){if(t.disabled=!0,this.reviewForm.invalid)return this.errors=[],(0,w.j)(this.reviewForm).forEach(o=>{this.errors.push(`${o.control} ${o.message}`)}),this.popup.show(),void(t.disabled=!1);this.review.createReview(this.reviewForm.value).subscribe({next:()=>{t.disabled=!1,this.route.navigate(["sets/my-sets"])},error:i=>{this.errors=[],this.errors.push(i.error.message),this.popup.show(),t.disabled=!1}})}onFileChange(t){const i=t.target;if(null===i.files)return;const o=i.files.length;for(let a=0;a<o;a++){const s=new FileReader;s.readAsDataURL(i.files[a]),s.onload=()=>{this.images.push(s.result),this.reviewForm.patchValue({setImages:this.images})}}}deleteImage(t){this.images.splice(t,1),this.reviewForm.patchValue({setImages:this.images})}linkValidator(t){return i=>{const o=i.controls[t];if(""===o.value||o.errors&&!o.errors.invalidLinks)return;const a=o.value.split(",").map(u=>u.trim()),s=a.every(u=>this.isValidUrl(u));return console.log(a),o.setErrors(s?null:{invalidLinks:!0}),s?null:{invalidLinks:!0}}}isValidUrl(t){return/^((?:https?:)?\/\/)?((?:www|m)\.)?((?:youtube(-nocookie)?\.com|youtu.be))(\/(?:[\w\-]+\?v=|embed\/|live\/|v\/)?)([\w\-]+)(\S+)?$/gm.test(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(p.gz),e.Y36(p.F0),e.Y36(l.qu),e.Y36(h.q),e.Y36(v.F))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-create-review"]],decls:24,vars:21,consts:[[3,"title","closed",4,"ngIf"],[1,"review-form",3,"formGroup","ngSubmit"],[3,"editor","toolbar"],["id","content","name","content","formControlName","content",3,"editor","placeholder"],[1,"form-group"],["for","images"],["type","file","id","setImages","name","images","multiple","","accept","image/*","formControlName","images",3,"change"],["for","setVideoIds"],["type","text","id","setVideoIds","name","setVideoIds","placeholder","Enter youtube URLs...","formControlName","setVideoIds"],["class","image-wrapper",4,"ngFor","ngForOf"],["type","hidden","id","_id","name","_id","formControlName","_id"],["button",""],[3,"title","closed"],[4,"ngFor","ngForOf"],[1,"image-wrapper"],[3,"src"],[1,"delete-button",3,"click"]],template:function(t,i){if(1&t){const o=e.EpF();e.YNc(0,M,3,4,"app-popup",0),e.TgZ(1,"form",1),e.NdJ("ngSubmit",function(){e.CHM(o);const s=e.MAs(21);return e.KtG(i.onSubmit(s))}),e.TgZ(2,"h2"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e._UZ(5,"ngx-editor-menu",2)(6,"ngx-editor",3),e.ALo(7,"translate"),e.TgZ(8,"div",4)(9,"label",5),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"input",6),e.NdJ("change",function(s){return i.onFileChange(s)}),e.qZA()(),e.TgZ(13,"div",4)(14,"label",7),e._uU(15),e.ALo(16,"translate"),e.qZA(),e._UZ(17,"input",8),e.qZA(),e.YNc(18,y,4,1,"div",9),e._UZ(19,"input",10),e.TgZ(20,"button",null,11),e._uU(22),e.ALo(23,"translate"),e.qZA()()}2&t&&(e.Q6J("ngIf",i.popup.isActive),e.xp6(1),e.Q6J("formGroup",i.reviewForm),e.xp6(2),e.Oqu(e.lcZ(4,11,"review.create-review.header")),e.xp6(2),e.Q6J("editor",i.editor)("toolbar",i.toolbar),e.xp6(1),e.s9C("placeholder",e.lcZ(7,13,"review.create-review.editor-placeholder")),e.Q6J("editor",i.editor),e.xp6(4),e.Oqu(e.lcZ(11,15,"review.create-review.images")),e.xp6(5),e.Oqu(e.lcZ(16,17,"review.create-review.videos")),e.xp6(3),e.Q6J("ngForOf",i.images),e.xp6(4),e.Oqu(e.lcZ(23,19,"review.create-review.button")))},dependencies:[d.sg,d.O5,_.R,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,g.tP,g.Mn,m.X$],styles:["[_nghost-%COMP%]{margin:2rem}.review-form[_ngcontent-%COMP%]{max-width:700px;margin:0 auto;padding:20px;background-color:#f7f7f7;border:1px solid #ccc;border-radius:4px}.review-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px}.form-group[_ngcontent-%COMP%]{margin-bottom:15px}label[_ngcontent-%COMP%]{display:block;font-weight:700;margin-bottom:12px}input[_ngcontent-%COMP%]{width:95%;padding:10px;border:1px solid #ccc;border-radius:4px}button[_ngcontent-%COMP%]{display:block;width:100%;padding:10px;margin-top:20px;background-color:green;color:#fff;border:none;border-radius:4px;cursor:pointer}button[_ngcontent-%COMP%]:hover{background-color:#015605}img[_ngcontent-%COMP%]{width:25%;height:auto;object-fit:cover}.image-wrapper[_ngcontent-%COMP%]{position:relative;display:inline}.delete-button[_ngcontent-%COMP%]{position:absolute;top:0;left:0;padding:4px 8px;background-color:red;color:#fff;border:none;border-radius:50%;cursor:pointer;z-index:1}.form-group[_ngcontent-%COMP%]{margin-top:10px}[_nghost-%COMP%]     .NgxEditor__Content{min-height:300px!important}"]}),n})();var A=c(3076),T=c(7852);const R=["youTubePlayer"];let I=(()=>{class n{constructor(t){this.changeDetectorRef=t}ngAfterViewInit(){this.onResize(),window.addEventListener("resize",this.onResize.bind(this))}onResize(){this.videoWidth=Math.min(this.player.nativeElement.clientWidth,1200),this.videoHeight=.6*this.videoWidth,this.changeDetectorRef.detectChanges()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-player"]],viewQuery:function(t,i){if(1&t&&e.Gf(R,5),2&t){let o;e.iGM(o=e.CRH())&&(i.player=o.first)}},inputs:{videoId:"videoId"},decls:3,vars:3,consts:[["youTubePlayer",""],[3,"width","height","videoId"]],template:function(t,i){1&t&&(e.TgZ(0,"div",null,0),e._UZ(2,"youtube-player",1),e.qZA()),2&t&&(e.xp6(2),e.Q6J("width",i.videoWidth)("height",i.videoHeight)("videoId",i.videoId))},dependencies:[T.D]}),n})();function F(n,r){if(1&n&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(t.customPopupContent)}}function k(n,r){if(1&n&&e._UZ(0,"img",15),2&n){const t=e.oxw(2);e.Q6J("src",t.enlargeImageSource,e.LSH)}}function q(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"app-popup",12),e.NdJ("closed",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.popup.hide())}),e.YNc(1,F,2,1,"p",13),e.YNc(2,k,1,1,"img",14),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.customPopupContent),e.xp6(1),e.Q6J("ngIf",!t.customPopupContent)}}const J=function(n){return["/reviews",n,"edit"]};function U(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",16)(1,"button",17),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"button",18),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.deleteReview())}),e._uU(5),e.ALo(6,"translate"),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("routerLink",e.VKq(7,J,null==t.review?null:t.review._id)),e.xp6(1),e.hij(" ",e.lcZ(3,3,"review.detail-review.edit")," "),e.xp6(3),e.hij(" ",e.lcZ(6,5,"review.detail-review.delete")," ")}}function L(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"img",21),e.NdJ("click",function(){const a=e.CHM(t).$implicit,s=e.oxw(2);return e.KtG(s.enlargeImage(a))}),e.qZA()}2&n&&e.Q6J("src",r.$implicit,e.LSH)}function N(n,r){if(1&n&&(e.TgZ(0,"div",19),e.YNc(1,L,1,1,"img",20),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",null==t.review?null:t.review.setImages)}}function E(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",22),e._UZ(1,"app-player",23),e.TgZ(2,"ul")(3,"li",24),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.previousVideo())}),e._uU(4,"Previous"),e.qZA(),e.TgZ(5,"li",24),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.nextVideo())}),e._uU(6,"Next"),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("videoId",t.activeVideo)}}function V(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",28)(1,"img",29),e.NdJ("click",function(){const a=e.CHM(t).$implicit,s=e.oxw(2);return e.KtG(s.enlargeImage(a.image))}),e.qZA(),e.TgZ(2,"h4"),e._uU(3),e.qZA(),e.TgZ(4,"p"),e._uU(5),e.ALo(6,"translate"),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(1),e.Q6J("src",t.image,e.LSH),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.AsE("",e.lcZ(6,4,"review.detail-review.qty"),": ",t.quantity,"")}}function Y(n,r){if(1&n&&(e.TgZ(0,"div",25)(1,"h2"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",26),e.YNc(5,V,7,6,"div",27),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"review.detail-review.minifigures")),e.xp6(3),e.Q6J("ngForOf",null==t.review?null:t.review.setMinifigures)}}let x=!1,S=(()=>{class n{constructor(t,i,o,a,s,u){this.reviewService=t,this.route=i,this.routeNavigate=o,this.popup=a,this.userService=s,this.translate=u,this.review=void 0,this.isImageEnlarged=!1,this.enlargeImageSource="",this.isOwner=!1,this.customPopupContent=void 0,this.playlist=[],this.currentIndex=0}ngOnInit(){if(!x){const t=document.createElement("script");t.src="https://www.youtube.com/iframe_api",document.body.appendChild(t),x=!0}this.route.data.subscribe(({review:t})=>{this.review=t,this.playlist=this.review.setVideoIds,this.activeVideo=this.playlist[this.currentIndex]}),this.editor=new g.ML,this.isOwner=this.userService.user?._id===this.review?.userId}ngOnDestroy(){this.editor.destroy()}previousVideo(){this.currentIndex--,this.currentIndex<0&&(this.currentIndex=0),this.activeVideo=this.playlist[this.currentIndex]}nextVideo(){this.currentIndex++,this.currentIndex===this.playlist.length&&this.currentIndex--,this.activeVideo=this.playlist[this.currentIndex]}enlargeImage(t){this.popup.show(),this.enlargeImageSource=t||""}deleteReview(){let t;this.translate.get("review.detail-review.alert").subscribe(i=>t=i),confirm(t)&&this.reviewService.deleteReview(this.review?._id).subscribe({next:()=>{this.routeNavigate.navigate(["sets/my-sets"])},error:i=>{this.customPopupContent=i.error.message,this.popup.show()}})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(v.F),e.Y36(p.gz),e.Y36(p.F0),e.Y36(h.q),e.Y36(A.K),e.Y36(m.sK))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-detail-review"]],decls:40,vars:35,consts:[["class","enlarged-image-container","title","",3,"closed",4,"ngIf"],[1,"user-container"],["class","buttons",4,"ngIf"],[1,"container"],[1,"set-image"],["width","100%",3,"src","alt","click"],[1,"set-info"],[1,"review-section"],[3,"editor","ngModel","disabled","ngModelChange"],["class","set-images",4,"ngIf"],["class","set-videos",4,"ngIf"],["class","minifigures",4,"ngIf"],["title","",1,"enlarged-image-container",3,"closed"],[4,"ngIf"],["class","enlarged-image","alt","Enlarged Image",3,"src",4,"ngIf"],["alt","Enlarged Image",1,"enlarged-image",3,"src"],[1,"buttons"],[1,"button-warning",3,"routerLink"],[1,"button-danger",3,"click"],[1,"set-images"],[3,"src","click",4,"ngFor","ngForOf"],[3,"src","click"],[1,"set-videos"],[3,"videoId"],[1,"playlist-item",3,"click"],[1,"minifigures"],[1,"minifigure-container"],["class","minifigure",4,"ngFor","ngForOf"],[1,"minifigure"],["alt","fig.name",3,"src","click"]],template:function(t,i){1&t&&(e.YNc(0,q,3,2,"app-popup",0),e.TgZ(1,"div",1)(2,"h2"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.YNc(5,U,7,9,"div",2),e.qZA(),e.TgZ(6,"div",3)(7,"div",4)(8,"img",5),e.NdJ("click",function(){return i.enlargeImage(null==i.review?null:i.review.setImage)}),e.qZA()(),e.TgZ(9,"div",6)(10,"h1"),e._uU(11),e.qZA(),e.TgZ(12,"p")(13,"strong"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e._uU(16),e.qZA(),e.TgZ(17,"p")(18,"strong"),e._uU(19),e.ALo(20,"translate"),e.qZA(),e._uU(21),e.qZA(),e.TgZ(22,"p")(23,"strong"),e._uU(24),e.ALo(25,"translate"),e.qZA(),e._uU(26),e.qZA(),e.TgZ(27,"p")(28,"strong"),e._uU(29),e.ALo(30,"translate"),e.qZA(),e._uU(31),e.qZA()()(),e.TgZ(32,"div",7)(33,"h2"),e._uU(34),e.ALo(35,"translate"),e.qZA(),e.TgZ(36,"ngx-editor",8),e.NdJ("ngModelChange",function(a){return i.review.content=a}),e.qZA()(),e.YNc(37,N,2,1,"div",9),e.YNc(38,E,7,1,"div",10),e.YNc(39,Y,6,4,"div",11)),2&t&&(e.Q6J("ngIf",i.popup.isActive),e.xp6(3),e.lnq(" ",null==i.review?null:i.review.setName," ",e.lcZ(4,23,"review.detail-review.from"),": ",null==i.review?null:i.review.userUsername," "),e.xp6(2),e.Q6J("ngIf",i.isOwner),e.xp6(3),e.Q6J("src",null==i.review?null:i.review.setImage,e.LSH)("alt",null==i.review?null:i.review.setName),e.xp6(3),e.Oqu(null==i.review?null:i.review.setName),e.xp6(3),e.hij("",e.lcZ(15,25,"review.detail-review.number"),":"),e.xp6(2),e.hij(" ",null==i.review?null:i.review.setNumber," "),e.xp6(3),e.hij("",e.lcZ(20,27,"general.review.parts"),":"),e.xp6(2),e.hij(" ",null==i.review?null:i.review.setParts," "),e.xp6(3),e.hij("",e.lcZ(25,29,"general.review.year"),":"),e.xp6(2),e.hij(" ",null==i.review?null:i.review.setYear," "),e.xp6(3),e.hij("",e.lcZ(30,31,"review.detail-review.minifigures"),":"),e.xp6(2),e.hij(" ",null==i.review?null:i.review.setMinifigCount," "),e.xp6(3),e.Oqu(e.lcZ(35,33,"review.detail-review.review")),e.xp6(2),e.Q6J("editor",i.editor)("ngModel",i.review.content)("disabled",!0),e.xp6(1),e.Q6J("ngIf",i.review.setImages.length>0),e.xp6(1),e.Q6J("ngIf",i.playlist.length>0),e.xp6(1),e.Q6J("ngIf",i.review.setMinifigures.length>0))},dependencies:[d.sg,d.O5,p.rH,_.R,l.JJ,g.tP,l.On,I,m.X$],styles:[".container[_ngcontent-%COMP%]{display:flex;background-color:orange;justify-content:center;margin-bottom:20px}.set-info[_ngcontent-%COMP%]{flex:1;max-width:400px;color:#fff;padding-right:20px}.set-image[_ngcontent-%COMP%]{flex:1;max-width:300px;margin:30px 50px 30px 30px}.review-section[_ngcontent-%COMP%], .minifigures[_ngcontent-%COMP%]{padding:10px;background-color:#fff;margin-bottom:20px}.minifigures[_ngcontent-%COMP%]{background-color:#fff}.minifigure[_ngcontent-%COMP%]{display:flex;align-items:center;gap:40px}.minifigure-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:20px}.minifigure[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:1px solid black;width:10%}.user-container[_ngcontent-%COMP%]{margin:50px auto 20px;background-color:green;padding:20px;border-radius:5px;color:#fff;display:flex;flex-direction:column;align-items:center;justify-content:center}.set-images[_ngcontent-%COMP%]{background-color:orange;margin-bottom:20px;display:flex;flex-wrap:wrap;gap:18px;padding:18px}.set-images[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{flex:1 0 auto;max-width:15%;height:auto}img[_ngcontent-%COMP%]{cursor:pointer}.enlarged-image-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.enlarged-image[_ngcontent-%COMP%]{max-width:80%}.buttons[_ngcontent-%COMP%]{display:flex;gap:10px}.button-danger[_ngcontent-%COMP%], .button-warning[_ngcontent-%COMP%]{color:#fff;border:none;outline:none;border-radius:5px;padding:8px 16px;font-size:14px;margin-top:10px;cursor:pointer}.button-danger[_ngcontent-%COMP%]{background-color:#bd1405}.button-warning[_ngcontent-%COMP%]{background-color:orange}.button-danger[_ngcontent-%COMP%]:hover{background-color:#9e2203}.button-warning[_ngcontent-%COMP%]:hover{background-color:#c98302}li.playlist-item[_ngcontent-%COMP%]{padding:10px;list-style:none;background:#e6e6e6;cursor:pointer;text-align:center;margin-bottom:5px}ul[_ngcontent-%COMP%]{padding:0;margin:0 auto}.set-videos[_ngcontent-%COMP%]{width:50%;background-color:#fff;margin:0 auto}@media only screen and (max-width: 600px){.set-info[_ngcontent-%COMP%], .set-image[_ngcontent-%COMP%]{max-width:100%}.container[_ngcontent-%COMP%]{flex-direction:column;justify-content:center;align-items:center}.set-info[_ngcontent-%COMP%]{padding:unset;text-align:center}.set-videos[_ngcontent-%COMP%]{margin:unset;width:100%}}@media only screen and (max-width: 1100px){.set-videos[_ngcontent-%COMP%]{margin:unset;width:100%}}"]}),n})();function j(n,r){if(1&n&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Oqu(t)}}function D(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"app-popup",12),e.NdJ("closed",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.popup.hide())}),e.ALo(1,"translate"),e.YNc(2,j,2,1,"p",13),e.qZA()}if(2&n){const t=e.oxw();e.s9C("title",e.lcZ(1,2,"general.error")),e.xp6(2),e.Q6J("ngForOf",t.errors)}}function H(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",14),e._UZ(1,"img",15),e.TgZ(2,"a",16),e.NdJ("click",function(){const a=e.CHM(t).index,s=e.oxw();return e.KtG(s.deleteImage(a))}),e._uU(3,"\xd7"),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(1),e.Q6J("src",t,e.LSH)}}let $=(()=>{class n{constructor(t,i,o,a,s){this.activated=t,this.route=i,this.fb=o,this.popup=a,this.review=s,this.errors=[],this.images=[],this.reviewForm=this.fb.group({content:["",[l.kI.required,l.kI.minLength(50),l.kI.maxLength(5e3)]],images:[""],setImages:[this.images],setVideoIds:[""],_id:[""]},{validator:this.linkValidator("setVideoIds")}),this.toolbar=[["bold","italic"],["underline","strike"],["ordered_list","bullet_list"],[{heading:["h1","h2","h3","h4","h5","h6"]}],["text_color","background_color"],["align_left","align_center","align_right","align_justify"]]}ngOnInit(){this.activated.data.subscribe(({review:t})=>{this.images=t.setImages,this.reviewForm.patchValue({content:t.content}),this.reviewForm.patchValue({setVideoIds:t.setVideoIds.map(i=>`https://www.youtube.com/watch?v=${i}`).join(", ")})}),this.reviewForm.patchValue({_id:this.activated.snapshot.params.id}),this.editor=new g.ML}ngOnDestroy(){this.editor.destroy()}onSubmit(t){if(t.disabled=!0,this.reviewForm.invalid)return this.errors=[],(0,w.j)(this.reviewForm).forEach(o=>{this.errors.push(`${o.control} ${o.message}`)}),this.popup.show(),void(t.disabled=!1);this.review.editReview(this.reviewForm.value).subscribe({next:()=>{t.disabled=!1,this.route.navigate(["reviews",this.reviewForm.get("_id")?.value])},error:i=>{this.errors=[],this.errors.push(i.error.message),this.popup.show(),t.disabled=!1}})}onFileChange(t){const i=t.target;if(null===i.files)return;const o=i.files.length;for(let a=0;a<o;a++){const s=new FileReader;s.readAsDataURL(i.files[a]),s.onload=()=>{this.images.push(s.result),this.reviewForm.patchValue({setImages:this.images})}}}deleteImage(t){this.images.splice(t,1),this.reviewForm.patchValue({setImages:this.images})}linkValidator(t){return i=>{const o=i.controls[t];if(""===o.value||o.errors&&!o.errors.invalidLinks)return;const s=o.value.split(",").map(u=>u.trim()).every(u=>this.isValidUrl(u));return o.setErrors(s?null:{invalidLinks:!0}),s?null:{invalidLinks:!0}}}isValidUrl(t){return/^((?:https?:)?\/\/)?((?:www|m)\.)?((?:youtube(-nocookie)?\.com|youtu.be))(\/(?:[\w\-]+\?v=|embed\/|live\/|v\/)?)([\w\-]+)(\S+)?$/gm.test(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(p.gz),e.Y36(p.F0),e.Y36(l.qu),e.Y36(h.q),e.Y36(v.F))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-edit-review"]],decls:23,vars:19,consts:[[3,"title","closed",4,"ngIf"],[1,"edit-form",3,"formGroup","ngSubmit"],[3,"editor","toolbar"],["id","content","name","content","formControlName","content",3,"editor","placeholder"],[1,"form-group"],["for","images"],["type","file","id","setImages","name","images","multiple","","accept","image/*","formControlName","images",3,"change"],["for","setVideoIds"],["type","text","id","setVideoIds","name","setVideoIds","placeholder","Enter youtube URLs...","formControlName","setVideoIds"],["class","image-wrapper",4,"ngFor","ngForOf"],["type","hidden","id","_id","name","_id","formControlName","_id"],["button",""],[3,"title","closed"],[4,"ngFor","ngForOf"],[1,"image-wrapper"],[3,"src"],[1,"delete-button",3,"click"]],template:function(t,i){if(1&t){const o=e.EpF();e.YNc(0,D,3,4,"app-popup",0),e.TgZ(1,"form",1),e.NdJ("ngSubmit",function(){e.CHM(o);const s=e.MAs(20);return e.KtG(i.onSubmit(s))}),e.TgZ(2,"h2"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e._UZ(5,"ngx-editor-menu",2)(6,"ngx-editor",3),e.TgZ(7,"div",4)(8,"label",5),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"input",6),e.NdJ("change",function(s){return i.onFileChange(s)}),e.qZA()(),e.TgZ(12,"div",4)(13,"label",7),e._uU(14),e.ALo(15,"translate"),e.qZA(),e._UZ(16,"input",8),e.qZA(),e.YNc(17,H,4,1,"div",9),e._UZ(18,"input",10),e.TgZ(19,"button",null,11),e._uU(21),e.ALo(22,"translate"),e.qZA()()}2&t&&(e.Q6J("ngIf",i.popup.isActive),e.xp6(1),e.Q6J("formGroup",i.reviewForm),e.xp6(2),e.Oqu(e.lcZ(4,11,"review.edit-review.header")),e.xp6(2),e.Q6J("editor",i.editor)("toolbar",i.toolbar),e.xp6(1),e.Q6J("editor",i.editor)("placeholder","Type here..."),e.xp6(3),e.Oqu(e.lcZ(10,13,"review.edit-review.images")),e.xp6(5),e.Oqu(e.lcZ(15,15,"review.edit-review.videos")),e.xp6(3),e.Q6J("ngForOf",i.images),e.xp6(4),e.Oqu(e.lcZ(22,17,"review.edit-review.edit")))},dependencies:[d.sg,d.O5,_.R,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,g.tP,g.Mn,m.X$],styles:["[_nghost-%COMP%]{margin:2rem}.edit-form[_ngcontent-%COMP%]{max-width:700px;margin:0 auto;padding:20px;background-color:#f7f7f7;border:1px solid #ccc;border-radius:4px}.review-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px}.form-group[_ngcontent-%COMP%]{margin-bottom:15px}label[_ngcontent-%COMP%]{display:block;font-weight:700;margin-bottom:12px}input[_ngcontent-%COMP%]{width:95%;padding:10px;border:1px solid #ccc;border-radius:4px}button[_ngcontent-%COMP%]{display:block;width:100%;padding:10px;margin-top:20px;background-color:green;color:#fff;border:none;border-radius:4px;cursor:pointer}button[_ngcontent-%COMP%]:hover{background-color:#015605}img[_ngcontent-%COMP%]{width:25%;height:auto;object-fit:cover}.image-wrapper[_ngcontent-%COMP%]{position:relative;display:inline}.delete-button[_ngcontent-%COMP%]{position:absolute;top:0;left:0;padding:4px 8px;background-color:red;color:#fff;border:none;border-radius:50%;cursor:pointer;z-index:1}.form-group[_ngcontent-%COMP%]{margin-top:10px}[_nghost-%COMP%]     .NgxEditor__Content{min-height:300px!important}"]}),n})();var G=c(7398),C=c(8495);let K=(()=>{class n{constructor(){this.searchEvent=new e.vpe}search(t){this.searchEvent.emit(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-search"]],outputs:{searchEvent:"searchEvent"},decls:7,vars:6,consts:[[1,"search-form"],["type","text",3,"placeholder"],["searchField",""],["type","button",3,"click"]],template:function(t,i){if(1&t){const o=e.EpF();e.TgZ(0,"div",0),e._UZ(1,"input",1,2),e.ALo(3,"translate"),e.TgZ(4,"button",3),e.NdJ("click",function(){e.CHM(o);const s=e.MAs(2);return e.KtG(i.search(s.value))}),e._uU(5),e.ALo(6,"translate"),e.qZA()()}2&t&&(e.xp6(1),e.s9C("placeholder",e.lcZ(3,2,"core.search.placeholder")),e.xp6(4),e.hij(" ",e.lcZ(6,4,"core.search.button")," "))},dependencies:[m.X$],styles:[".search-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end}.search-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:10px;border:1px solid #ccc;border-radius:4px}button[_ngcontent-%COMP%]{color:#fff;background-color:#4caf50;border:none;border-radius:5px;padding:8px 16px;font-size:14px;margin-top:10px;cursor:pointer}button[_ngcontent-%COMP%]:focus{outline:none}button[_ngcontent-%COMP%]:hover{background-color:#45a049}"]}),n})();function X(n,r){if(1&n&&e._UZ(0,"img",3),2&n){const t=e.oxw().$implicit;e.s9C("src",t.userImage,e.LSH)}}const B=function(n){return["/sets",n]},W=function(n){return["/reviews",n]};function ee(n,r){if(1&n&&(e.TgZ(0,"div",2),e._UZ(1,"img",3),e.TgZ(2,"div",4)(3,"div",5),e._uU(4),e.qZA(),e.TgZ(5,"div",6),e.YNc(6,X,1,1,"img",7),e.TgZ(7,"div",8)(8,"span"),e._uU(9),e.ALo(10,"translate"),e.TgZ(11,"strong",9),e._uU(12),e.qZA()(),e.TgZ(13,"span"),e._uU(14),e.qZA()()(),e.TgZ(15,"div",10)(16,"button",11),e._uU(17),e.ALo(18,"translate"),e.qZA()()()()),2&n){const t=r.$implicit;e.xp6(1),e.s9C("src",t.image,e.LSH),e.xp6(3),e.hij(" ",t.name," "),e.xp6(2),e.Q6J("ngIf",t.userImage),e.xp6(3),e.hij("",e.lcZ(10,9,"general.review.author"),": "),e.xp6(2),e.Q6J("routerLink",e.VKq(13,B,t.username)),e.xp6(1),e.Oqu(t.username),e.xp6(2),e.Oqu(t.reviewDate),e.xp6(2),e.Q6J("routerLink",e.VKq(15,W,t._id)),e.xp6(1),e.hij(" ",e.lcZ(18,11,"general.review.view")," ")}}const te=[{path:"",pathMatch:"full",component:(()=>{class n{constructor(t,i,o){this.activatedRoute=t,this.setService=i,this.router=o}ngOnInit(){this.sets$=this.activatedRoute.data.pipe((0,G.U)(t=>t.sets))}searchSets(t){t?(this.router.navigate([""],{queryParams:{setNumber:t}}),this.sets$=this.setService.getAll(t)):this.sets$=this.setService.getAll()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(p.gz),e.Y36(C.z),e.Y36(p.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-all-reviews"]],decls:4,vars:3,consts:[[3,"searchEvent"],["class","card",4,"ngFor","ngForOf"],[1,"card"],[3,"src"],[1,"card-content"],[1,"card-title"],[1,"card-details"],[3,"src",4,"ngIf"],[1,"card-details__info"],[1,"user-link",3,"routerLink"],[1,"card-actions"],[1,"card-button",3,"routerLink"]],template:function(t,i){1&t&&(e.TgZ(0,"app-search",0),e.NdJ("searchEvent",function(a){return i.searchSets(a)}),e.qZA(),e.TgZ(1,"ul"),e.YNc(2,ee,19,17,"div",1),e.ALo(3,"async"),e.qZA()),2&t&&(e.xp6(2),e.Q6J("ngForOf",e.lcZ(3,1,i.sets$)))},dependencies:[d.sg,d.O5,p.rH,K,d.Ov,m.X$],styles:["ul[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,270px);gap:20px;justify-content:center;align-items:center;padding:0}@media screen and (min-device-width: 668px) and (max-device-width: 1124px) and (orientation: portrait){ul[_ngcontent-%COMP%]{grid-template-columns:repeat(2,300px)}}@media screen and (min-device-width: 668px) and (max-device-width: 1124px) and (orientation: landscape){ul[_ngcontent-%COMP%]{grid-template-columns:repeat(3,300px)}}@media screen and (max-device-width: 480px) and (orientation: portrait){ul[_ngcontent-%COMP%]{grid-template-columns:1fr}}@media screen and (max-device-width: 640px) and (orientation: landscape){ul[_ngcontent-%COMP%]{grid-template-columns:1fr}}@media screen and (max-device-width: 640px){ul[_ngcontent-%COMP%]{grid-template-columns:1fr}}.card[_ngcontent-%COMP%]{background-color:#fff;border-radius:5px;box-shadow:0 2px 4px #0000001a;display:flex;flex-direction:column;overflow:hidden;max-width:300px;height:340px}.card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto;height:200px;object-fit:contain}.card-content[_ngcontent-%COMP%]{padding:10px;display:flex;flex-direction:column}.card-title[_ngcontent-%COMP%]{font-weight:700;align-self:center;margin-bottom:5px}.card-details[_ngcontent-%COMP%]{display:flex;gap:10px;margin-top:10px;align-items:center;justify-content:center;height:35px}.card-details[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:35px;height:35px;border-radius:50%;object-fit:cover}.card-details__info[_ngcontent-%COMP%]{display:flex;flex-direction:column;font-size:14px;color:#888;justify-content:center}.card-button[_ngcontent-%COMP%]{color:#fff;background-color:#4caf50;border:none;border-radius:5px;padding:8px 16px;font-size:14px;margin-top:10px;cursor:pointer}.card-button[_ngcontent-%COMP%]:focus{outline:none}.card-button[_ngcontent-%COMP%]:hover{background-color:#45a049}.card-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-around}.user-link[_ngcontent-%COMP%]{color:#d18904;cursor:pointer}@media (max-width: 600px){.card[_ngcontent-%COMP%]{max-width:100%;height:auto}}"]}),n})(),title:"All Reviews",resolve:{sets:(n,r)=>(0,e.f3M)(C.z).getAll(n.queryParams.setNumber)}},{path:":id/create",component:P,canActivate:[Z._],title:"Create Review"},{path:":id",component:S,title:"Review",resolve:{review:(n,r)=>(0,e.f3M)(v.F).getReview(n.params.id)}},{path:":id/edit",component:$,title:"Edit Review",resolve:{review:(n,r)=>(0,e.f3M)(v.F).getReview(n.params.id)}}];let ne=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[p.Bz.forChild(te),p.Bz]}),n})();var ie=c(8081);let oe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[d.ez,ne,b.m,l.UX,g.FP,l.u5,ie.I,m.aw,m.aw]}),n})()}}]);